<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>非遗皮影艺术 - 中国传统文化的瑰宝</title>
    <script src="https://cdn.tailwindcss.com/3.3.3"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #f8f4e9;
            color: #4a3a2a;
        }
        .hero-section {
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('https://p3-search.byteimg.com/obj/labis/19649f7aad6d0ecaf143a0fddc21aa14');
            background-size: cover;
            background-position: center;
        }
        .shadow-custom {
            box-shadow: 0 10px 25px -5px rgba(138, 99, 51, 0.3);
        }
        .timeline-item:not(:last-child)::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: -20px;
            width: 2px;
            height: 20px;
            background-color: #d4a373;
        }
        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .speech-btn {
            transition: all 0.3s ease;
        }
        .speech-btn:hover {
            transform: scale(1.1);
        }
        
        /* 修改后的等高布局样式 */
        .style-item {
            display: flex;
            flex-direction: row;
            gap: 16px;
            align-items: stretch;
        }
        
        .style-content {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .style-img-container {
                flex: 0 0 180px; /* 进一步缩小图片容器宽度，从200px改为180px */
                display: flex;
                align-items: center;
                justify-content: center;
                height: auto;
                cursor: pointer;
            }
        
        .style-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 12px;
            box-shadow: 0 6px 16px -8px rgba(138, 99, 51, 0.5);
            transition: transform 0.3s ease;
        }
        
        .style-img:hover {
            transform: scale(1.05);
        }
        
        /* 语音图标样式 */
        .speech-icon {
            cursor: pointer;
            opacity: 0.7;
            margin-left: 8px;
            color: #333;
            transition: all 0.3s;
        }
        
        .speech-icon.playing {
            opacity: 1;
            color: #0066cc;
            animation: pulse 1.5s infinite;
        }
        
        .speech-icon:hover {
            opacity: 1;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        /* 段落播放时高亮 */
        .p-playing {
            background-color: #fff9c4;
            transition: background-color 0.3s ease;
        }

        /* 图片查看模态框样式 */
        .image-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            overflow: auto;
        }
        
        .modal-content {
            margin: auto;
            display: block;
            max-width: 90%;
            max-height: 90%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
        }
        
        .close-btn {
            position: absolute;
            top: 20px;
            right: 30px;
            color: white;
            font-size: 35px;
            font-weight: bold;
            cursor: pointer;
            z-index: 1001;
        }
        
        .caption {
            margin: auto;
            display: block;
            width: 80%;
            text-align: center;
            color: #ccc;
            padding: 10px 0;
            position: absolute;
            bottom: 20px;
            left: 10%;
            z-index: 1001;
        }
        
        /* 导航箭头 */
        .nav-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 50px;
            cursor: pointer;
            z-index: 1001;
            opacity: 0.7;
            transition: opacity 0.3s;
        }
        
        .nav-arrow:hover {
            opacity: 1;
        }
        
        .prev {
            left: 30px;
        }
        
        .next {
            right: 30px;
        }
		 body {
		            font-family: 'Noto Sans SC', sans-serif;
		            background-color: #f8f1e5;
		            color: #5c3a21;
		            overflow-x: hidden;
		        }
		        
		        .shadow-paper {
		            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
		        }
		        
		        .shadow-paper-hover {
		            transition: all 0.3s ease;
		        }
		        
		        .shadow-paper-hover:hover {
		            transform: translateY(-5px);
		            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
		        }
		        
		        .modal-overlay {
		            background-color: rgba(0, 0, 0, 0.5);
		            backdrop-filter: blur(5px);
		        }
		        
		        .modal-content {
		            background: linear-gradient(to bottom, #fff9e6, #f8f1e5);
		            border: 2px solid #d4a76a;
		        }
		        
		        .btn-primary {
		            background-color: #d4a76a;
		            color: white;
		            transition: all 0.3s ease;
		        }
		        
		        .btn-primary:hover {
		            background-color: #b38b56;
		            transform: translateY(-2px);
		        }
		        
		        .puppet-animation {
		            animation: float 3s ease-in-out infinite;
		        }
		        
		        @keyframes float {
		            0%, 100% { transform: translateY(0); }
		            50% { transform: translateY(-10px); }
		        }
		        
		        .map-container {
		            height: 600px;
		            width: 100%;
		            position: relative;
		            border: 8px solid #d4a76a;
		            border-radius: 8px;
		            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
		        }
		        
		        .puppet-style-tag {
		            display: inline-block;
		            padding: 4px 12px;
		            background-color: #d4a76a;
		            color: white;
		            border-radius: 16px;
		            font-size: 14px;
		            margin-right: 8px;
		            margin-bottom: 8px;
		        }
		        
		        .map-hotspot {
		            position: absolute;
		            width: 40px;
		            height: 40px;
		            border-radius: 50%;
		            background-color: rgba(212, 167, 106, 0.3);
		            border: 2px solid #d4a76a;
		            cursor: pointer;
		            display: flex;
		            align-items: center;
		            justify-content: center;
		            transition: all 0.3s ease;
		        }
		        
		        .map-hotspot:hover {
		            background-color: rgba(212, 167, 106, 0.5);
		            transform: scale(1.1);
		        }
		        
		        .map-hotspot::after {
		            content: '';
		            position: absolute;
		            width: 20px;
		            height: 20px;
		            border-radius: 50%;
		            background-color: #d4a76a;
		            animation: pulse 2s infinite;
		        }
		        
		        @keyframes pulse {
		            0% {
		                transform: scale(0.8);
		                opacity: 0.7;
		            }
		            70% {
		                transform: scale(1.3);
		                opacity: 0;
		            }
		            100% {
		                transform: scale(0.8);
		                opacity: 0;
		            }
		        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="bg-amber-900 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center">
                <i class="fas fa-theater-masks text-2xl mr-2"></i>
                <span class="text-xl font-bold">非遗皮影艺术</span>
            </div>
            <div class="hidden md:flex space-x-6">
                <a href="概述.html" class="nav-link">概述</a>
                <a href="历史渊源.html" class="nav-link">历史渊源</a>
                <a href="制作工艺.html" class="nav-link">制作工艺</a>
                <a href="艺术流派.html" class="nav-link">艺术流派</a>
                <a href="传承发展.html" class="nav-link">传承发展</a>
                <a href="视频欣赏.html" class="nav-link">视频欣赏</a>
            </div>
            <button id="mobileMenuBtn" class="md:hidden text-xl focus:outline-none">
                <i class="fas fa-bars"></i>
            </button>
			<button id="theme-toggle">切换主题</button>
        </div>
        <!-- 移动端菜单 -->
        <div id="mobileMenu" class="hidden md:hidden bg-amber-800 px-4 py-2">
            <a href="概述.html" class="block py-2 hover:text-amber-200 transition nav-link">概述</a>
            <a href="历史渊源.html" class="block py-2 hover:text-amber-200 transition nav-link">历史渊源</a>
            <a href="制作工艺.html" class="block py-2 hover:text-amber-200 transition nav-link">制作工艺</a>
            <a href="艺术流派.html" class="block py-2 hover:text-amber-200 transition nav-link">艺术流派</a>
            <a href="传承发展.html" class="block py-2 hover:text-amber-200 transition nav-link">传承发展</a>
            <a href="视频欣赏.html" class="block py-2 hover:text-amber-200 transition nav-link">视频欣赏</a>
        </div>
    </nav>

    <!-- 图片查看模态框 -->
    <div id="imageModal" class="image-modal">
        <span class="close-btn">&times;</span>
        <a class="nav-arrow prev" onclick="changeImage(-1)">&#10094;</a>
        <a class="nav-arrow next" onclick="changeImage(1)">&#10095;</a>
        <img class="modal-content" id="modalImage">
        <div id="caption" class="caption"></div>
    </div>

    <!-- 艺术流派 -->
    <section id="styles" class="py-16 bg-amber-50">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold mb-12 text-center text-amber-900">
                <i class="fas fa-palette mr-2"></i>艺术流派
            </h2>
            <div style="width: 60%; margin: 20px auto; overflow: hidden; border-radius: 20px;">
                <img src="images/E8612E18A19585CB7E00950D8B53AF32.jpg" style="width: 100%; border-radius: 20px;" class="viewable-image" onclick="openImageModal(this)">
            </div>
            <div class="max-w-4xl mx-auto">
                <div class="bg-white rounded-xl p-6 shadow-custom mb-8" id="introContent">
                    <div class="flex items-center">
                        <h3 class="text-2xl font-semibold mb-4 text-amber-800">皮影艺术流派</h3>
                        <i class="fas fa-volume-up speech-icon" id="introSpeechIcon"></i>
                    </div>
                    <p>由于皮影戏在中国流传地域广阔，在不同区域的长期演化过程中，形成了不同流派，常见有四川皮影、湖北皮影、湖南皮影、北京皮影、唐山皮影、山东皮影、山西皮影、青海皮影、宁夏皮影、陕西皮影，以及川北皮影、陇东皮影等风格各具特色的地方皮影。</p>
                </div>
                
                <div class="grid md:grid-cols-1 gap-8">
                    <!-- 唐山皮影戏 - 左文右图等高布局 -->
                    <div class="style-item bg-white rounded-xl p-6 shadow-custom mb-8" id="tangshanContent">
                        <div class="style-content">
                            <div class="flex items-center">
                                <h3 class="text-2xl font-semibold mb-4 text-amber-800">唐山皮影戏</h3>
                                <i class="fas fa-volume-up speech-icon" id="tangshanSpeechIcon"></i>
                            </div>
                            <p>唐山皮影又称滦州影、乐亭影、驴皮影，是中国皮影戏中影响较大的种类之一。唐山皮影戏的主要操纵演员有两人，即"上线"和"下线"。支配影人动作的杆子有3根，分别叫"主杆"和"手杆"。
                            唐山皮影戏演出通常有拿、贴、打、拉、唱五种分工，有"七忙八闲"之说。</p>
                        </div>
                        <div class="style-img-container">
                            <img src="images/唐山皮影戏.png" alt="唐山皮影戏" class="style-img viewable-image" onclick="openImageModal(this)">
                        </div>
                    </div>
                    
                    <!-- 北京皮影戏 - 左文右图等高布局 -->
                    <div class="style-item bg-white rounded-xl p-6 shadow-custom mb-8" id="beijingContent">
                        <div class="style-content">
                            <div class="flex items-center">
                                <h3 class="text-2xl font-semibold mb-4 text-amber-800">北京皮影戏</h3>
                                <i class="fas fa-volume-up speech-icon" id="beijingSpeechIcon"></i>
                            </div>
                            <p>北京皮影戏形成时期长，表现手法独特，有着不同于其他地区皮影戏的艺术特色，这种区别主要表现在表演、声腔、造型、制作工艺等方面。表演更细腻、夸张，声腔吸收了昆曲、京剧、曲艺等
                            北京地方剧、曲种的声腔、曲调，造型设计则吸收了京剧脸谱、服饰特色，更加突出了人物的情感和神态的塑造。</p>
                        </div>
                        <div class="style-img-container">
                            <img src="images/北京皮影戏.png" alt="北京皮影戏" class="style-img viewable-image" onclick="openImageModal(this)">
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-xl p-6 shadow-custom" id="otherContent">
                        <div class="flex items-center">
                            <h3 class="text-2xl font-semibold mb-4 text-amber-800">其他流派</h3>
                            <i class="fas fa-volume-up speech-icon" id="otherSpeechIcon"></i>
                        </div>
                        <p>还有如华县皮影戏、华阴老腔、阿宫腔、弦板腔、环县道情皮影戏、凌源皮影戏等，都各具特色。</p>
                    </div>
                </div>
                
                <div class="mt-8">
                    <img src="images/其它皮影戏.png" alt="各地皮影戏特色展示" class="w-full rounded-lg shadow-lg viewable-image" onclick="openImageModal(this)">
                </div>
            </div>
        </div>
    </section>
  <!-- 头部横幅 -->
    <header class="bg-amber-800 text-white py-12">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-4">探索中国皮影艺术流派</h1>
            <p class="text-xl md:text-2xl mb-8">点击地图上的地区，发现各地皮影的独特魅力</p>
            <div class="flex justify-center">
                <div class="bg-amber-700 px-6 py-2 rounded-full shadow-md">
                    <i class="fas fa-hand-pointer mr-2"></i>点击地图开始探索
                </div>
            </div>
        </div>
    </header>

    <!-- 地图区域 -->
    <section id="map" class="py-12 bg-amber-50">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold mb-8 text-center text-amber-900">皮影艺术流派分布</h2>
            <div class="map-container" id="puppetMap">
                <img src="images/地图.jpg" alt="中国皮影艺术地图" class="w-full h-full object-cover">
                <!-- 地图热点区域 -->
                <div class="map-hotspot" style="top: 45%; left: 55%;" data-region="华县皮影"></div>
                <div class="map-hotspot" style="top: 28%; left: 65%;" data-region="唐山皮影"></div>
                <div class="map-hotspot" style="top: 65%; left: 45%;" data-region="四川皮影"></div>
                <div class="map-hotspot" style="top: 55%; left: 60%;" data-region="湖北皮影"></div>
                <div class="map-hotspot" style="top: 65%; left: 60%;" data-region="湖南皮影"></div>
                <div class="map-hotspot" style="top: 45%; left: 67%;" data-region="山东皮影"></div>
            </div>
        </div>
    </section>

    <!-- 模态框模板 -->
    <div id="puppetModal" class="fixed inset-0 z-50 flex items-center justify-center hidden modal-overlay">
        <div class="bg-white rounded-lg w-11/12 md:w-3/4 lg:w-1/2 max-h-screen overflow-y-auto modal-content p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 id="modalTitle" class="text-2xl font-bold text-amber-900"></h2>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <div id="puppetAnimation" class="w-full h-64 bg-amber-100 rounded-lg flex items-center justify-center mb-4">
                        <img id="puppetImage" src="" alt="" class="max-h-full max-w-full puppet-animation">
                    </div>
                    <audio id="puppetAudio" controls class="w-full mb-4"></audio>
                </div>
                
                <div>
                    <h3 class="text-xl font-semibold mb-2 text-amber-800">艺术特色</h3>
                    <p id="puppetStyle" class="text-amber-700 mb-4"></p>
                    
                    <div id="styleTags" class="mb-4"></div>
                    
                    <h3 class="text-xl font-semibold mb-2 text-amber-800">特色剧目</h3>
                    <p id="puppetPlays" class="text-amber-700"></p>
                </div>
            </div>
            
            <div class="mt-6 flex justify-center">
                <button id="learnMore" class="btn-primary px-6 py-2 rounded-full font-medium">
                    <i class="fas fa-book mr-2"></i>了解更多
                </button>
            </div>
        </div>
    </div>
    <!-- 页脚 -->
    <footer class="bg-amber-900 text-white py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <p class="text-sm">© 2025 非遗皮影艺术保护与传承</p>
					<video id="backgroundMusic" controls src="music/1.mp3" height="20" width="150" autostart="true" autoplay hidden></video>
                </div>
                <div class="flex space-x-4">
                    <a href="#" class="hover:text-amber-200 transition"><i class="fab fa-weixin text-xl"></i></a>
                    <a href="#" class="hover:text-amber-200 transition"><i class="fab fa-weibo text-xl"></i></a>
                    <a href="#" class="hover:text-amber-200 transition"><i class="fab fa-tiktok text-xl"></i></a>
                </div>
            </div>
        </div>
    </footer>
<script>
	// 获取背景音乐元素
	const backgroundMusic = document.getElementById('backgroundMusic');
	
	// 页面加载时恢复播放状态和音量
	window.addEventListener('load', function() {
	    const savedTime = localStorage.getItem('musicTime');
	    const savedVolume = localStorage.getItem('musicVolume');
	
	    if (savedTime) {
	        backgroundMusic.currentTime = parseFloat(savedTime);
	    }
	
	    if (savedVolume) {
	        backgroundMusic.volume = parseFloat(savedVolume);
	    }
	});
	
	// 页面卸载时保存播放状态和当前时间
	window.addEventListener('beforeunload', function() {
	    localStorage.setItem('musicTime', backgroundMusic.currentTime);
	    localStorage.setItem('musicVolume', backgroundMusic.volume);
	});
	
	// 音量控制、暂停与开始功能示例
	const playPauseButton = document.createElement('button');
	playPauseButton.textContent = '暂停';
	playPauseButton.addEventListener('click', function() {
	    if (backgroundMusic.paused) {
	        backgroundMusic.play();
	        playPauseButton.textContent = '暂停';
	    } else {
	        backgroundMusic.pause();
	        playPauseButton.textContent = '播放';
	    }
	});
	
	const volumeControl = document.createElement('input');
	volumeControl.type = 'range';
	volumeControl.min = 0;
	volumeControl.max = 1;
	volumeControl.step = 0.1;
	volumeControl.value = backgroundMusic.volume;
	volumeControl.addEventListener('input', function() {
	    backgroundMusic.volume = parseFloat(this.value);
	});
	
	// 将控制按钮添加到页面
	const footer = document.querySelector('footer');
	footer.appendChild(playPauseButton);
	footer.appendChild(volumeControl);
</script>
    <script>
        // 语音播报管理器
        const SpeechManager = {
            synth: window.speechSynthesis,
            currentSection: null,
            isPaused: false,
            speechSections: {},
            
            init: function() {
                // 初始化所有语音部分
                this.speechSections = {
                    intro: {
                        icon: document.getElementById('introSpeechIcon'),
                        content: document.getElementById('introContent'),
                        position: 0,
                        utterance: null
                    },
                    tangshan: {
                        icon: document.getElementById('tangshanSpeechIcon'),
                        content: document.getElementById('tangshanContent'),
                        position: 0,
                        utterance: null
                    },
                    beijing: {
                        icon: document.getElementById('beijingSpeechIcon'),
                        content: document.getElementById('beijingContent'),
                        position: 0,
                        utterance: null
                    },
                    other: {
                        icon: document.getElementById('otherSpeechIcon'),
                        content: document.getElementById('otherContent'),
                        position: 0,
                        utterance: null
                    }
                };

                // 检查浏览器支持
                if (!('speechSynthesis' in window)) {
                    Object.values(this.speechSections).forEach(section => {
                        if (section.icon) section.icon.style.display = 'none';
                    });
                    return;
                }

                // 为每个语音图标添加点击事件
                Object.keys(this.speechSections).forEach(key => {
                    const section = this.speechSections[key];
                    if (section.icon && section.content) {
                        section.icon.addEventListener('click', () => this.handleSpeechIconClick(key));
                    }
                });

                // 监听页面离开事件
                window.addEventListener('beforeunload', () => this.stopCurrentSpeech());
                
                // 监听导航链接点击事件
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        // 阻止默认行为，先停止语音再跳转
                        e.preventDefault();
                        this.stopCurrentSpeech();
                        
                        // 延迟跳转以确保语音完全停止
                        setTimeout(() => {
                            window.location.href = link.getAttribute('href');
                        }, 100);
                    });
                });
                
                // 监听移动端菜单链接点击事件
                document.querySelectorAll('#mobileMenu .nav-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        // 阻止默认行为，先停止语音再跳转
                        e.preventDefault();
                        this.stopCurrentSpeech();
                        
                        // 延迟跳转以确保语音完全停止
                        setTimeout(() => {
                            window.location.href = link.getAttribute('href');
                        }, 100);
                    });
                });
            },
            
            handleSpeechIconClick: function(key) {
                // 如果点击的是当前正在播放的部分
                if (this.currentSection === key) {
                    if (this.synth.speaking && !this.isPaused) {
                        this.pauseSpeech();
                    } else if (this.isPaused) {
                        this.resumeSpeech();
                    } else {
                        this.playSpeech(key);
                    }
                } else {
                    // 停止当前播放并开始新的部分
                    this.stopCurrentSpeech();
                    this.playSpeech(key);
                }
            },
            
            playSpeech: function(key) {
                const section = this.speechSections[key];
                if (!section) return;
                
                this.currentSection = key;
                this.isPaused = false;
                
                // 获取要朗读的文本
                const text = section.content.querySelector('p').textContent.substring(section.position);
                
                // 创建新的语音实例
                section.utterance = new SpeechSynthesisUtterance(text);
                section.utterance.lang = 'zh-CN';
                section.utterance.rate = 0.9;
                
                // 语音开始回调
                section.utterance.onstart = () => {
                    section.icon.classList.add('playing');
                    section.content.classList.add('p-playing');
                    section.icon.classList.remove('fa-play');
                    section.icon.classList.add('fa-pause');
                };
                
                // 语音结束回调
                section.utterance.onend = () => {
                    section.icon.classList.remove('playing');
                    section.content.classList.remove('p-playing');
                    section.position = 0;
                    section.icon.classList.remove('fa-pause');
                    section.icon.classList.add('fa-volume-up');
                    this.currentSection = null;
                    this.isPaused = false;
                };
                
                // 语音错误回调
                section.utterance.onerror = (event) => {
                    console.error('语音播报错误:', event.error);
                    section.icon.classList.remove('playing');
                    section.content.classList.remove('p-playing');
                    section.icon.classList.remove('fa-pause');
                    section.icon.classList.add('fa-volume-up');
                    this.currentSection = null;
                    this.isPaused = false;
                };
                
                // 记录已播报的字符位置
                section.utterance.onboundary = (event) => {
                    if (event.name === 'word') {
                        section.position = event.charIndex + event.charLength;
                    }
                };
                
                // 开始播报
                this.synth.speak(section.utterance);
            },
            
            pauseSpeech: function() {
                if (this.currentSection && this.synth.speaking && !this.isPaused) {
                    this.synth.pause();
                    this.isPaused = true;
                    const section = this.speechSections[this.currentSection];
                    section.icon.classList.remove('fa-pause');
                    section.icon.classList.add('fa-play');
                }
            },
            
            resumeSpeech: function() {
                if (this.currentSection && this.isPaused) {
                    this.synth.resume();
                    this.isPaused = false;
                    const section = this.speechSections[this.currentSection];
                    section.icon.classList.remove('fa-play');
                    section.icon.classList.add('fa-pause');
                }
            },
            
            stopCurrentSpeech: function() {
                if (this.currentSection) {
                    const section = this.speechSections[this.currentSection];
                    this.synth.cancel();
                    section.icon.classList.remove('playing');
                    section.content.classList.remove('p-playing');
                    section.icon.classList.remove('fa-pause', 'fa-play');
                    section.icon.classList.add('fa-volume-up');
                    this.currentSection = null;
                    this.isPaused = false;
                }
            }
        };

        // 图片查看功能
        let currentImageIndex = 0;
        let allImages = [];
        
        function openImageModal(imgElement) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const captionText = document.getElementById('caption');
            
            // 收集页面中所有可查看的图片
            allImages = Array.from(document.querySelectorAll('.viewable-image'));
            currentImageIndex = allImages.indexOf(imgElement);
            
            modal.style.display = "block";
            modalImg.src = imgElement.src;
            captionText.innerHTML = imgElement.alt;
            
            // 点击关闭按钮
            document.querySelector('.close-btn').onclick = function() {
                modal.style.display = "none";
            }
            
            // 点击模态框外部关闭
            modal.onclick = function(event) {
                if (event.target === modal) {
                    modal.style.display = "none";
                }
            }
            
            // 按ESC键关闭
            document.addEventListener('keydown', function(event) {
                if (event.key === "Escape" && modal.style.display === "block") {
                    modal.style.display = "none";
                } else if (event.key === "ArrowLeft") {
                    changeImage(-1);
                } else if (event.key === "ArrowRight") {
                    changeImage(1);
                }
            });
        }
        
        function changeImage(direction) {
            currentImageIndex += direction;
            
            // 循环处理
            if (currentImageIndex >= allImages.length) {
                currentImageIndex = 0;
            } else if (currentImageIndex < 0) {
                currentImageIndex = allImages.length - 1;
            }
            
            const modalImg = document.getElementById('modalImage');
            const captionText = document.getElementById('caption');
            
            // 添加动画效果
            modalImg.style.opacity = 0;
            setTimeout(() => {
                modalImg.src = allImages[currentImageIndex].src;
                captionText.innerHTML = allImages[currentImageIndex].alt;
                modalImg.style.opacity = 1;
            }, 200);
        }

        // 移动端菜单切换
        document.getElementById('mobileMenuBtn').addEventListener('click', function() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        });

        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        });

        // 初始化语音管理器
        document.addEventListener('DOMContentLoaded', function() {
            SpeechManager.init();
        });
		// 皮影流派数据
		        const puppetData = {
		            "华县皮影": {
		                image: "https://s.coze.cn/image/L43EKrv69uA/",
		                audio: "https://lf-bot-studio-plugin-resource.coze.cn/obj/bot-studio-platform-plugin-tos/artist/image/3ea7775ffc4b44908a71e7451543c410.wav",
		                style: "华县皮影造型玲珑夸张、变化精妙，人物形象生动活泼，线条流畅优美，具有很高的艺术价值。唱腔有碗碗腔和老腔。",
		                styleTags: ["玲珑夸张", "变化精妙", "线条流畅"],
		                plays: "特色剧目有《金殿》《青狮吐八宝》等"
		            },
		            "唐山皮影": {
		                image: "https://s.coze.cn/image/ziPTucCsmXg/",
		                audio: "https://lf-bot-studio-plugin-resource.coze.cn/obj/bot-studio-platform-plugin-tos/artist/image/ced26cf84d7f4f7888257c885b9d9695.wav",
		                style: "唐山皮影造型遵循'平面化、卡通化、艺术化、戏曲化'原则，人物形象夸张生动，色彩鲜艳明快。唱腔有独特掐嗓唱法。",
		                styleTags: ["平面化", "卡通化", "艺术化", "戏曲化"],
		                plays: "特色剧目有《封神榜》《青云剑》等"
		            },
		            "四川皮影": {
		                image: "https://s.coze.cn/image/JpkDGRd6OyY/",
		                audio: "https://lf-bot-studio-plugin-resource.coze.cn/obj/bot-studio-platform-plugin-tos/artist/image/0c3f83988e6c40a2b82825b57e0680d0.wav",
		                style: "四川皮影造型夸张、滑稽，脸谱和服饰多模仿川剧，具有浓厚的地方特色和幽默感。唱腔借鉴川剧五大声腔。",
		                styleTags: ["夸张滑稽", "川剧风格", "幽默风趣"],
		                plays: "特色剧目有《破镜重圆》《竹枝词》等"
		            },
		            "湖北皮影": {
		                image: "https://s.coze.cn/image/8VoUDRC1eqg/",
		                audio: "https://lf-bot-studio-plugin-resource.coze.cn/obj/bot-studio-platform-plugin-tos/artist/image/e7a6e48e86a846c59a84de6039b0a716.wav",
		                style: "湖北皮影雕镂图案精细、圆润舒展，人物形象端庄大方，具有浓郁的地方文化特色。唱腔以歌腔、渔鼓腔为主。",
		                styleTags: ["雕镂精细", "圆润舒展", "端庄大方"],
		                plays: "特色剧目有《郑成功收复台湾》《岳飞大战爱华山》等"
		            },
		            "湖南皮影": {
		                image: "https://s.coze.cn/image/VNgRn1lyKXw/",
		                audio: "https://lf-bot-studio-plugin-resource.coze.cn/obj/bot-studio-platform-plugin-tos/artist/image/aabeb44e00c64fcdbda605b6466f5a6e.wav",
		                style: "湖南皮影造型根据剧情和人物性格而定，形象生动传神，富有表现力和感染力。唱腔不断创新。",
		                styleTags: ["生动传神", "富有表现力", "感染力强"],
		                plays: "特色剧目有《龟与鹤》《三只老鼠》等"
		            },
		            "山东皮影": {
		                image: "https://s.coze.cn/image/KWjPfxrB3i0/",
		                audio: "https://lf-bot-studio-plugin-resource.coze.cn/obj/bot-studio-platform-plugin-tos/artist/image/879a5f2391254549a7fcd5dab73b81a6.wav",
		                style: "山东皮影造型简朴，刻工粗犷，人物形象朴实厚重，具有浓郁的乡土气息。唱腔主要是柳琴调。",
		                styleTags: ["简朴粗犷", "朴实厚重", "乡土气息"],
		                plays: "特色剧目多为神话传奇和当地流传的历史传说"
		            }
		        };
		
		        // 初始化地图点击区域
		        document.addEventListener('DOMContentLoaded', function() {
		            const map = document.getElementById('puppetMap');
		            const modal = document.getElementById('puppetModal');
		            const closeBtn = document.getElementById('closeModal');
		            const learnMoreBtn = document.getElementById('learnMore');
		            
		            // 为地图热点添加点击事件
		            document.querySelectorAll('.map-hotspot').forEach(hotspot => {
		                hotspot.addEventListener('click', function() {
		                    const region = this.getAttribute('data-region');
		                    showPuppetInfo(region);
		                });
		            });
		            
		            // 关闭模态框
		            closeBtn.addEventListener('click', function() {
		                modal.classList.add('hidden');
		                const audio = document.getElementById('puppetAudio');
		                audio.pause();
		            });
		            
		            // 了解更多按钮
		            learnMoreBtn.addEventListener('click', function() {
		                const region = document.getElementById('modalTitle').textContent;
		                // 不进行外部链接跳转，改为显示更多信息
		                alert(`这里是${region}的详细介绍内容`);
		            });
		            
		            // 点击模态框外部关闭
		            modal.addEventListener('click', function(e) {
		                if(e.target === modal) {
		                    modal.classList.add('hidden');
		                    const audio = document.getElementById('puppetAudio');
		                    audio.pause();
		                }
		            });
		            
		            // 显示皮影信息
		            function showPuppetInfo(region) {
		                const data = puppetData[region];
		                
		                document.getElementById('modalTitle').textContent = region;
		                document.getElementById('puppetImage').src = data.image;
		                document.getElementById('puppetImage').alt = `${region}皮影形象`;
		                document.getElementById('puppetAudio').src = data.audio;
		                document.getElementById('puppetStyle').textContent = data.style;
		                document.getElementById('puppetPlays').textContent = data.plays;
		                
		                // 清空并添加风格标签
		                const tagsContainer = document.getElementById('styleTags');
		                tagsContainer.innerHTML = '';
		                data.styleTags.forEach(tag => {
		                    const span = document.createElement('span');
		                    span.className = 'puppet-style-tag';
		                    span.textContent = tag;
		                    tagsContainer.appendChild(span);
		                });
		                
		                modal.classList.remove('hidden');
		            }
		        });
    </script>
	<script src="theme-toggle.js"></script>
</body>
</html>